FROM node:22.12.0-alpine

# ğŸ”§ DÃ©pendances systÃ¨me nÃ©cessaires Ã  la compilation
RUN apk add --no-cache bash git curl make g++ python3 py3-pip

# ğŸ“ RÃ©pertoire de travail
WORKDIR /app

# ğŸ“¦ Copie ciblÃ©e uniquement de package.json (PAS de lock)
COPY package.json ./

# ğŸ”¥ Purge totale si copie forcÃ©e
RUN rm -f package-lock.json && rm -rf node_modules

# ğŸ“Œ Forcer version TypeScript
RUN npm install typescript@5.2.2 --save-exact --legacy-peer-deps

# ğŸ§© Installer toutes les autres dÃ©pendances Angular
RUN npm install --legacy-peer-deps --verbose

# ğŸ“ Enfin, copie du reste du projet
COPY . .
